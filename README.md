# agentic-apigee-infra

This repository contains the Infrastructure as Code (IaC) for deploying the Agentic Apigee solution using Terraform.

## Prerequisites

Before you begin, ensure you have the following tools installed:

- [Google Cloud SDK](https://cloud.google.com/sdk/docs/install) (`gcloud`)
- Terraform
- uv (a fast Python package installer and virtual environment manager)

## Setup

1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd agentic-apigee-infra
    ```

2.  **Authenticate with Google Cloud:**
    ```bash
    gcloud auth application-default login
    ```

3.  **Set up the Python environment using `uv`:**
    ```bash
    # Create a virtual environment in the .venv directory
    uv venv

    # Activate the virtual environment
    source .venv/bin/activate

    # Install any required Python packages
    uv sync
    ```

## Configuration: Generate `uris.tfvars`

The `uris.tfvars` file will be generated by extracting the URLs from the Apigee documentation menu site, the `doc_menu` folder contains a sample of the extracted menus for each section in the Apigee documentation.

The Terraform deployment requires a variables file named `uris.tfvars` that contains service URLs. A helper script is provided to generate this file. Update the script to include or exclude more services as needed.

Run the following command from the root of the repository:
```bash
uv run extract_uris.py
```
This command will create the `uris.tfvars` file needed for the next step.

## Deployment with Terraform

After setting up and configuring the project, you can deploy the infrastructure.

1.  **Navigate to the Terraform directory and deploy:**
    ```bash
    # Initialize the Terraform working directory
    terraform init

    # Check the an execution plan to preview changes
    terraform plan -var project="your-project-id" -var-file="uris.tfvars"

    # If everithing is ok: Apply the changes to deploy the infrastructure
    terraform apply -var project="your-project-id" -var-file="uris.tfvars" -auto-approve
    ```
